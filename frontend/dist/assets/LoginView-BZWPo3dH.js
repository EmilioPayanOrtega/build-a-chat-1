import{d as _,r as i,c as n,a as t,b as c,w as h,e as f,v as g,f as v,t as x,g as k,h as C,i as V,n as I,u as S,o as u}from"./index-IGaj96A5.js";import{l as E}from"./api-DOUZDINy.js";const N={class:"w-full flex justify-center items-center animate-fade-in"},B={class:"card"},M={class:"field"},R={key:0,class:"text-red-500 text-xs mt-1"},T={class:"field"},z={key:0,class:"text-red-500 text-xs mt-1"},L={key:1,class:"text-red-500 text-xs mt-1"},U={class:"pt-2"},j=["disabled"],q={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},D={class:"mt-6 text-center text-sm text-gray-600"},G=_({__name:"LoginView",setup(A){const o=i(""),s=i(""),a=i(!1),l=i(""),m=i("ok"),d=i(!1),b=S();async function w(){if(d.value=!1,l.value="",!o.value||!s.value||s.value.length<6){d.value=!0;return}a.value=!0;try{const r=await E({nombre_usuario:o.value,password:s.value});r.success?(l.value=r.msg||"¡Inicio de sesión exitoso!",m.value="ok",localStorage.setItem("user_id",String(r.user_id)),localStorage.setItem("username",o.value),setTimeout(()=>{b.push("/dashboard")},1e3)):(l.value=r.error||"Error al iniciar sesión",m.value="error",a.value=!1)}catch(r){l.value=r instanceof Error?r.message:"Error al iniciar sesión",m.value="error",a.value=!1}}return(r,e)=>{const y=V("RouterLink");return u(),n("section",N,[t("div",B,[e[7]||(e[7]=t("h2",{class:"page-title"},"Inicio de sesión",-1)),t("form",{onSubmit:h(w,["prevent"]),novalidate:"",class:"space-y-6"},[t("div",M,[e[2]||(e[2]=t("label",{for:"identifier",class:"text-sm font-medium text-gray-700 mb-1"},"Usuario o correo electrónico",-1)),f(t("input",{id:"identifier","onUpdate:modelValue":e[0]||(e[0]=p=>o.value=p),class:"input",name:"identifier",type:"text",autocomplete:"username",placeholder:"Ingresa tu usuario",required:""},null,512),[[g,o.value,void 0,{trim:!0}]]),d.value&&!o.value?(u(),n("span",R,"Campo obligatorio")):c("",!0)]),t("div",T,[e[3]||(e[3]=t("label",{for:"password",class:"text-sm font-medium text-gray-700 mb-1"},"Contraseña",-1)),f(t("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=p=>s.value=p),class:"input",name:"password",type:"password",autocomplete:"current-password",placeholder:"••••••••",required:"",minlength:"6"},null,512),[[g,s.value]]),d.value&&!s.value?(u(),n("span",z,"Campo obligatorio")):c("",!0),d.value&&s.value&&s.value.length<6?(u(),n("span",L,"Mínimo 6 caracteres")):c("",!0)]),t("div",U,[t("button",{class:"btn primary w-full flex justify-center items-center gap-2",type:"submit",disabled:a.value},[a.value?(u(),n("svg",q,[...e[4]||(e[4]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),v(" "+x(a.value?"Ingresando…":"Iniciar sesión"),1)],8,j)])],32),t("p",D,[e[6]||(e[6]=v(" ¿No tienes cuenta? ",-1)),k(y,{to:"/register",class:"font-medium text-blue-600 hover:text-blue-500 transition-colors"},{default:C(()=>[...e[5]||(e[5]=[v("Regístrate ya",-1)])]),_:1})]),l.value?(u(),n("div",{key:0,class:I(["mt-4 p-3 rounded-lg text-sm text-center font-medium",m.value==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"])},x(l.value),3)):c("",!0)])])}}});export{G as default};
